function initializePlugins(){$('input[name="arrFilter_ff[NAME]"]').attr("placeholder","По названию"),$('input[name="arrFilter_DATE_CREATE_1"]').attr("placeholder","По дате от"),$('input[name="arrFilter_DATE_CREATE_2').attr("placeholder","По дате до"),$('form[name="arrFilter_form"] input').on("change",(function(){$('input[name="set_filter"]').trigger("click")}));const e=gsap.timeline();let t=0;window.addEventListener("scroll",(function(e){var a;$(window).scrollTop()+$(window).height()===(a=document,Math.max(a.body.scrollHeight,a.documentElement.scrollHeight,a.body.offsetHeight,a.documentElement.offsetHeight,a.body.clientHeight,a.documentElement.clientHeight))?$("#footer_nav").removeClass("active"):$("#footer_nav").addClass("active"),t=$(this).scrollTop()})),$(".print_btn").on("click",(function(){!function(e){let t=window.open("","_blank","width=1200,height=800");t.document.open(),t.document.write('<html><body onload="window.print()">'+$(e).html()+"</html>"),t.document.close()}($(this).next(".block_to_print"))})),$(".accordion_item_wrap").on("click",(function(){let t=$(this).parent(".accordion_item");$(".accordion_item_content").hide(200);let a=$(t).children("ul.accordion_item_content");$(t).hasClass("active")?(e.to($(a),{opacity:0,duration:.2}),$(a).hide(200),$(t).removeClass("active")):($(".accordion_list li").removeClass("active"),$(t).addClass("active"),$(a).show(200),e.to($(a),{opacity:1,duration:.2}))})),$(".popup-gallery").magnificPopup({delegate:"a",type:"image",tLoading:"Loading image #%curr%...",mainClass:"mfp-img-mobile",gallery:{enabled:!0,navigateByImgClick:!0,preload:[0,1]},image:{tError:'<a href="%url%">изображение #%curr%</a> не удалось загрузить.',titleSrc:function(e){return e.el.attr("title")?e.el.attr("title"):"АМС г. Владикавказ"}}}),$("body").removeAttr("class"),$("#mobile-menu").removeAttr("class");let a=$(".mmenu_btn");$("#mobile-menu").remove(),a.removeClass("active"),$(".menu").after("<div id='mobile-menu'>").clone().appendTo("#mobile-menu"),$("#mobile-menu").find("*").attr("style","");let n=$("#mobile-menu").children("ul").removeClass("menu").parent().mmenu({extensions:["position-right","widescreen","theme-white","effect-menu-slide","pagedim-black"],navbar:{title:"АМС г. Владикавказ"},counters:!0}).data("mmenu");function s(){$(".modal_loader").fadeIn(200),$(".tab_item").on("click",(function(){if($(this).hasClass("active"))$(".tab_item").removeClass("active"),$(".tab_content").fadeOut();else{$(".tab_item").removeClass("active"),$(this).addClass("active");let e=$(".tab_item.active").data("tab");$(".tab_content").fadeOut(),$(`.tab_content[data-tab-content="${e}"]`).fadeIn()}}));C("#answer_file_input",!1,!1);$(".responsible_search").on("input",(function(){$(this).val().length>0?$(this).next().addClass("is_active"):$(this).next().removeClass("is_active"),$.ajax({type:"GET",url:"../bitrix/templates/app/api/person.php",data:{query:$(this).val()},beforeSend:function(){NProgress.start()},complete:function(){NProgress.done()},success:function(e){$(".responsible_search_list").html(""),e.success&&(e.departament.forEach((e=>{$(".responsible_search_list").append(`<li data-id="${e.name}" data-val="${e.name}">${e.name}<span>${e.cheif}</span></li>`)})),$(".responsible_search_list").slideDown(),$(".responsible_search_list li").on("click",(function(){$(".responsible_search").val($(this).data("val")),$(".responsible_search_list").slideUp()})))},error:function(e){b(5e3,"error","Ошибка загрузки!",e)}})})),$(".responsible_add").on("click",(function(){let e=$(this).parent().find(".responsible_search");$(".timeline").find('li[data-event="add_responsible"]').length>0?o("change_responsible",$(e).data("id")):o("add_responsible",$(e).data("id"))})),$(".right_panel_content .group").each((function(){let e=$(this).find("label"),t=$(this).find("input"),a=$(this).find("textarea");$(t).val()&&$(t).val().length>0||$(a).val()&&$(a).val().length>0?$(e).addClass("is_active"):$(e).removeClass("is_active")})),$(".feed-detail-status-line").each((function(){let e=$(this).data("status-active"),t=$(this).find(`li[data-status-id="${e}"]`),a=$(this).find("li");$(t).nextAll().length>0&&$(t).nextAll().addClass("is_none"),$(a).on("click",(function(){$(this).nextAll().addClass("is_none"),$(this).removeClass("is_none"),$(".modal_loader").fadeIn(200),o("change_status",$(this).data("status-id"))}))})),$(".modal_loader").fadeOut(200)}function o(e,t){$.ajax({type:"POST",url:"../bitrix/templates/app/api/change_feed_app.php",data:{action:e,element:$(".feed-detail").data("elid"),status:t},beforeSend:function(){NProgress.start()},complete:function(){NProgress.done()},success:function(e){var t;e.success&&(t=$(".feed-detail").data("elid"),$.ajax({type:"GET",url:"../bitrix/templates/app/api/application_detail.php",data:{id:t},beforeSend:function(){NProgress.start()},complete:function(){NProgress.done()},success:function(e){$(".right_panel_content").html(e),s()},error:function(e){b(5e3,"error","Ошибка загрузки!",e)}}))},error:function(e){b(5e3,"error","Ошибка загрузки!",e)}})}void 0!==n&&a.on("click",(function(){n.open()})),$(".actual_item").length>0&&window.addEventListener("load",(function(){e.to(".actual_item",{scale:1,opacity:1,duration:.2,stagger:.1,ease:"elastic"})})),$("[data-panel]").on("click",(function(){$(".right_panel").remove();let e=`<div class="right_panel">\n                            <div class="modal_loader"> <svg version="1.1" id="L7" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve">\n                                    <path fill="#fff" d="M31.6,3.5C5.9,13.6-6.6,42.7,3.5,68.4c10.1,25.7,39.2,38.3,64.9,28.1l-3.1-7.9c-21.3,8.4-45.4-2-53.8-23.3c-8.4-21.3,2-45.4,23.3-53.8L31.6,3.5z" transform="rotate(312.597 50 50)">\n                                        <animateTransform attributeName="transform" attributeType="XML" type="rotate" dur="2s" from="0 50 50" to="360 50 50" repeatCount="indefinite"></animateTransform>\n                                    </path>\n                                    <path fill="#fff" d="M42.3,39.6c5.7-4.3,13.9-3.1,18.1,2.7c4.3,5.7,3.1,13.9-2.7,18.1l4.1,5.5c8.8-6.5,10.6-19,4.1-27.7c-6.5-8.8-19-10.6-27.7-4.1L42.3,39.6z" transform="rotate(-265.194 50 50)">\n                                        <animateTransform attributeName="transform" attributeType="XML" type="rotate" dur="1s" from="0 50 50" to="-360 50 50" repeatCount="indefinite"></animateTransform>\n                                    </path>\n                                    <path fill="#fff" d="M82,35.7C74.1,18,53.4,10.1,35.7,18S10.1,46.6,18,64.3l7.6-3.4c-6-13.5,0-29.3,13.5-35.3s29.3,0,35.3,13.5L82,35.7z" transform="rotate(312.597 50 50)">\n                                        <animateTransform attributeName="transform" attributeType="XML" type="rotate" dur="2s" from="0 50 50" to="360 50 50" repeatCount="indefinite"></animateTransform>\n                                    </path>\n                                </svg> </div>\n                            <div class="right_panel_close"><i class="fa fa-times"></i></div>\n                            <header class="right_panel_header">\n                            <h2 class="right_panel_title">${$(this).data("title")}</h2>\n                            <span class="right_panel_date">${$(this).data("date")}</span>\n                            </header>\n                            <div class="right_panel_content"></div>\n                        </div>`;$("body").append(e);let t=$(".right_panel"),a=$(this).children(".item_title").text(),n=$(t).children(".right_panel_title"),i=$(t).children(".right_panel_content");$(".modal_loader").fadeIn(200),$(t).addClass("open");let o={id:$(this).data("id")},l=$(this).data("url");$.ajax({type:"GET",url:l,data:o,beforeSend:function(){NProgress.start()},complete:function(){NProgress.done(),$(".modal_loader").fadeOut(200)},success:function(e){$(n).text(a),$(i).html(e),$(".right_panel_close").on("click",(function(){$(".right_panel").removeClass("open"),$(".right_panel").remove()})),s()},error:function(e){b(5e3,"error","Ошибка загрузки!",e)}})}));let l=new Proxy({iblock:null,section:null,date:null,sort:"desc",type:"",PAGEN_1:1},{get:function(e,t){return Reflect.get(e,t)},set:function(e,t,a){return setTimeout((()=>{!function(e){$.ajax({type:"GET",url:"/bitrix/templates/app/api/document.php",data:e,beforeSend:function(){NProgress.start()},complete:function(){NProgress.done()},success:function(e){$(".tooltip-inner").remove(),$(".document_list").html(e),$(".paginationjs-page").on("click",(function(){l.PAGEN_1=$(this).attr("data-pagenum"),$("html, body").animate({scrollTop:0},"slow")})),$(".act").on("click",(function(){l.PAGEN_1=$(this).attr("data-pagenum"),$("html, body").animate({scrollTop:0},"slow")})),$('[data-toggle="tooltip"]').tooltip({animated:"fade",html:!0}),k(),r()},error:function(e){b(5e3,"error","Ошибка загрузки!",e)}})}(e)}),10),Reflect.set(e,t,a)}});function r(){$(".download_zip").on("click",(function(){let e=$(this).parent(),t=$(e).children("li"),a=[];t.map((e=>{$(t[e]).hasClass("download_zip")||a.push({filename:$(t[e]).find(".folder-item__details__name").text(),filepath:$(t[e]).find("a").attr("href")})})),$.ajax({type:"POST",url:"/bitrix/templates/app/api/zip.php",data:{files:JSON.stringify(a)},beforeSend:function(){NProgress.start()},complete:function(){NProgress.done()},success:function(e){console.log(e),window.open(`http://vladikavkaz-osetia.ru/download_zip.php?download=${e.download}&path=${e.path}&name=${e.name}`,"_blank")},error:function(e){b(5e3,"error","Ошибка загрузки!",e)}})}))}$("#filter_document").each((function(){let e=$(".document_list").data("iblock")?$(".document_list").data("iblock"):null,t=$(this).find("input#filter_name"),a=$(this).find("select#filter_section"),n=$(this).find("input#filter_date"),i=$(this).find("button#filter_sort");l.iblock=e,$(t).on("input",(function(){l.name=$(this).val()})),$(n).on("input",(function(){$(this).val().length>=0&&(l.date=null)})),$(n).datepicker({onSelect:function(e,t,a){t&&(l.date=e)}}).data("datepicker"),$(a).select2({}),$(a).on("change",(function(){"all"==$(this).val()?l.section="#":l.section=$(this).val()})),$(i).on("click",(function(){let e=$(this).attr("data-sort",(function(e,t){return"desc"==t?"asc":"desc"})),t=$(e).attr("data-sort");"asc"==t?$(this).html('<i class="fa fa-sort-amount-asc"></i> По возрастанию'):$(this).html('<i class="fa fa-sort-amount-desc"></i> По убыванию'),l.sort=t}))})),r(),function(){let e=$(".tabs > .active"),t=$(".tab__content"),a=t.find(".active"),n=a.outerHeight();a.show(),t.height(n),$(".tabs > li").on("click",(function(){$(".tabs > li").removeClass("active"),$(this).addClass("active"),e=$(".tabs .active"),a.fadeOut(250,(function(){$(".tab__content > li").removeClass("active");var i=e.index();$(".tab__content > li").eq(i).addClass("active"),a=$(".tab__content > .active"),n=a.outerHeight(),t.stop().delay(50).animate({height:n},500,(function(){a.delay(50).fadeIn(250)}))}))}))}(),$(document).on("click",".load_more",(function(){var e=$(".ajax-list"),t=$(".load_more").attr("data-url");void 0!==t&&$.ajax({type:"GET",url:t,dataType:"html",success:function(t){$(".load_more").remove();var a=$(t).find(".ajax-list-item"),n=$(t).find(".load_more");e.append(a),e.append(n)}})})),null!==localStorage.getItem("banner")?$(".banner").hide():$(".banner").fadeIn(300),$(".banner .btn_close").on("click",(function(){$(".banner").hide(),localStorage.setItem("banner","hide")})),null!==localStorage.getItem("view")?($(".view_btn button").removeClass("active"),$(`.view_btn button.${localStorage.getItem("view")}`).addClass("active"),$(".tree").attr("data-view",localStorage.getItem("view"))):($(".view_btn button").removeClass("active"),$(`.view_btn button.${$(".tree").attr("data-view")}`).addClass("active")),$(".view_btn button").on("click",(function(){$(".view_btn button").removeClass("active"),$(this).toggleClass("active"),"utter"==$(this).attr("data-view")?(localStorage.setItem("view","utter"),$(".tree").attr("data-view","utter")):(localStorage.removeItem("view"),$(".tree").attr("data-view","small"))})),$(".bs-tooltip-bottom").remove(),$('[data-toggle="tooltip"]').tooltip({animated:"fade",html:!0}),$(".popover").remove(),$('[data-toggle="popover"]').popover({html:!0,placement:"bottom",container:"body"}),$(".tree_item").popover({html:!0,container:"body"}),$(".tree ul li:first-child ul li").each((function(){let e=$(this),t=$(e).children("ul");$(t).hide().addClass("hide")})),$(".tree_item").each((function(){let e=$(this).parent("li"),t=$(e).children("ul");$(this).find(".select_btn").remove(),$(t).length&&!$(t).hasClass("hide")?$(this).append('<button class="select_btn">Свернуть <i class="fa fa-chevron-up"></i></button>'):$(t).length&&$(t).hasClass("hide")?$(this).append('<button class="select_btn active">Развернуть <i class="fa fa-chevron-down"></i></button>'):$(this).find(".select_btn").remove()})),$(".select_btn").on("click",(function(){let e=$(this).parent(".tree_item").parent("li"),t=$(e).children("ul");t.length>0&&$(this).toggleClass("active"),$(this).hasClass("active")?($(this).html('Развернуть <i class="fa fa-chevron-down"></i>'),$(t).hide()):($(this).html('Свернуть <i class="fa fa-chevron-up"></i>'),$(t).show())})),$(".tree_small li:has(ul)").addClass("parent_li").find(" > span").attr("title","Collapse this branch"),$(".tree_small li.parent_li > span").on("click",(function(e){var t=$(this).parent("li.parent_li").find(" > ul > li");t.is(":visible")?(t.hide("fast"),$(this).attr("title","Expand this branch").find(" > i").addClass("fa-plus-square").removeClass("fa-minus-square")):(t.show("fast"),$(this).attr("title","Collapse this branch").find(" > i").addClass("fa-minus-square").removeClass("fa-plus-square")),e.stopPropagation()})),$("#month_sel").select2({language:"ru"}),$("#year_sel").select2({language:"ru"}),$("#news_cat").select2({language:"ru"}),$("#modal_app_form").iziModal({headerColor:"#62D4BD",width:840,top:50,bottom:50,radius:5,onFullscreen:function(){$(".modal_loader").fadeIn("slow")},onResize:function(){$(".modal_loader").fadeOut("slow")},onOpening:function(){x(),$("#app_form_departament").select2({language:"ru"}),$(".modal_loader").fadeIn("slow"),$(".submit_disabled").show(),$(".btn_submit").hide()},onOpened:function(){$(".modal_loader").fadeOut("slow")},onClosing:function(){},onClosed:function(){},afterRender:function(){}}),$("#need_person").on("change",(function(){$(this).is(":checked")?$("#person").select2({language:"ru"}):$("#person").select2("destroy")})),$("form.app_form").validate({errorElement:"span"});let c=[];function d(e,t=!1){let a=$(e).data("event-num"),n=$(e).find("span.form_tab_event");t?($(e).addClass("is_valid"),$(n).html('<i class="fa fa-check"></i>')):($(e).removeClass("is_valid"),$(n).html(a))}function p(e){let t=$(e),a=$(t).find(".show_more");$(t).each((function(){let e=$(this).data("url"),n=$(this).data("amount"),i=$(this).find(".item:gt("+(n-1)+")").fadeOut();$(a).on("click",(function(){$(this).toggleClass("active"),$(this).hasClass("active")?($(this).html('Скрыть <i class="fa fa-chevron-up"></i>'),i.fadeIn(300),$(t).append(`<a class="show_all" href="${e}">Показать все <i class="fa fa-angle-right"></i></a>`)):($(this).html('Раскрыть <i class="fa fa-chevron-down"></i>'),$(t).find("a.show_all").remove(),i.fadeOut(300))}))}))}$("#app_form_persondata_23").mask("+7 (000) 000-00-00",{onChange:function(e){$("#app_form_persondata_23").next(".error_message").remove()},onInvalid:function(e,t,a,n,i){let s=n[0];$(t.target).next(".error_message").remove(),$(t.target).after(`<span class="error_message">${s.p-2} не валидный сивол!</span>`)}}),$("#app_form_persondata_24").on("input",(function(){var e;(e=$(this).val(),/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e))?$(this).next(".error_message").remove():($(this).next(".error_message").remove(),$(this).after('<span class="error_message">Не валидная е-почта!</span>'))})),$("#app_form_consent").each((function(){let e=$(this).closest(".form_tab"),t=$(e).data("event-num"),a=$(e).find(".form_tab_event");$(this).is(":checked")?($(e).addClass("is_valid"),$(a).html('<i class="fa fa-check"></i>'),c.push(t)):($(e).removeClass("is_valid"),$(a).html(t))})),$(".btn_submit").hide(),$("select#app_form_departament").on("select2:select",(function(e){"#"==e.target.value?($(e.target).addClass("err"),$(".app_form .select2-container .select2-selection--single").css({"border-color":"#e25460"})):($(e.target).removeClass("err"),$(".app_form .select2-container .select2-selection--single").css({"border-color":"#62d4bd"}))})),$(".btn_submit_disabled").on("click",(function(){let e=$("select#app_form_departament").val(),t=$(".app_form .select2-selection--single"),a=[...$("input[required]")],n=[...$("textarea[required]")];"#"==e?($(t).addClass("err"),$(".app_form .select2-container.select2-selection--single").css({"border-color":"#e25460"})):($(t).removeClass("err"),$(".app_form .select2-container.select2-selection--single").css({"border-color":"#62d4bd"})),a.forEach((e=>{""==$(e).val()||0==$(e).val().length&&!$(e).is(":checked")?$(e).addClass("err"):$(e).removeClass("err")})),n.forEach((e=>{0==$(e).val().length?$(e).addClass("err"):$(e).removeClass("err")}));let i=$(".err");if(i.length>0){let e=$(i[0]).offset().top-$(".app_form").offset().top-$(".app_form").scrollTop()-20;$(this).parent().find("span.error").remove(),$(this).parent().append('<span class="error" style="text-align: center;">Возможно вы пропустили обязательные поля, перепроверьте все поля</span>'),$(".iziModal-wrap").animate({scrollTop:e},300)}else $(".submit_disabled").hide(),$(".btn_submit").show()})),$(".form_tab").on("change",(function(){let e=this,t=$(this).find("textarea"),a=$(this).find("input[required]"),n=$(this).find("select#app_form_departament"),i=$(this).find("select#person"),s=$(this).find("input#app_form_persondata_18"),o=$(this).find("input#need_person"),l=$(this).data("event-num"),r=$(this).find("#app_form_consent"),p=$(".btn_submit"),f=[],h=[];if($(a).each((function(){""!==this.value?($(this).addClass("valid"),f.push({input:$(this).data("input"),status:!0})):($(this).removeClass("valid"),f.push({input:$(this).data("input"),status:!1}));let t=f.filter((e=>!0===e.status)).length;$(s).is(":checked")?6===t?d(e,!0):d(e):5===t?d(e,!0):d(e)})),$(t).each((function(){0==this.value.length?h.push({textarea:$(this).data("textarea"),status:!1}):h.push({textarea:$(this).data("textarea"),status:!0}),2===h.filter((e=>!0===e.status)).length?d(e,!0):d(e)})),$(n).each((function(){"#"!=this.value&&""!=this.value?d(e,!0):d(e)})),$(o).is(":checked")&&("#"!=$(i).val()&&""!=$(i).val()?d(e,!0):d(e)),$(r).each((function(){$(this).is(":checked")?d(e,!0):d(e)})),$(this).hasClass("is_valid"))c.includes(l)||c.push(l);else{let e=c.indexOf(l);e>-1&&c.splice(e,1)}c.length>=4?($(".form_tab").addClass("is_valid"),$(".form_submit").addClass("is_valid"),$(".submit_disabled").hide(),$(p).show(),$(p).prop("disabled",!1)):($(".form_submit").removeClass("is_valid"),$(".submit_disabled").show(),$(p).hide(),$(p).prop("disabled",!0))})),$("#app_form_persondata_25").suggestions({token:"fd6932ba741e45fb66a5724df848eb4a15478eda",type:"ADDRESS",onSelect:function(e){}}),$("#app_form_persondata_24").suggestions({token:"fd6932ba741e45fb66a5724df848eb4a15478eda",type:"EMAIL",onSelect:function(e){$("#app_form_persondata_24").next(".error_message").remove()}}),$("#app_form_persondata_20").suggestions({token:"fd6932ba741e45fb66a5724df848eb4a15478eda",type:"NAME",onSelect:function(e){}}),$("#app_form_persondata_21").suggestions({token:"fd6932ba741e45fb66a5724df848eb4a15478eda",type:"NAME",onSelect:function(e){}}),$("#app_form_persondata_22").suggestions({token:"fd6932ba741e45fb66a5724df848eb4a15478eda",type:"NAME",onSelect:function(e){}}),$("input#app_form_persondata_18").on("change",(function(){let e=$("input#app_form_persondata_20"),t=$("input#app_form_persondata_21"),a=$("input#app_form_persondata_22"),n=$("input#app_form_persondata_24"),i=$("input#app_form_persondata_25"),s=$("input#app_form_persondata_23");$(this).is(":checked")?($("#orgname")&&$("#orgname").remove(),$(this).parent().after('<div class="group" id="orgname">\n                                <input required data-input="orgname" type="text" name="orgname" id="app_form_persondata_19" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="suggestions-input">\n                                <label>Название организации*</label>\n                            </div>'),$(e).parent().children("label").text("Фамилия руководителя*"),$(t).parent().children("label").text("Имя руководителя*"),$(a).parent().children("label").text("Отчество руководителя"),$(n).parent().children("label").text("Е-почта организации*"),$(s).parent().children("label").text("Контактный телефон*"),$(i).parent().children("label").text("Адрес организации*"),$("#app_form_persondata_19").suggestions({token:"fd6932ba741e45fb66a5724df848eb4a15478eda",type:"PARTY",onSelect:function(e){if(e.data){let t="";switch(e.data.type){case"INDIVIDUAL":t=e.data.name.full.split(" ");break;default:t=e.data.management.name.split(" ")}$("#app_form_persondata_19").parent(".group").children("label").addClass("is_active"),$("#app_form_persondata_20").val(t[0]).parent(".group").children("label").addClass("is_active"),$("#app_form_persondata_21").val(t[1]).parent(".group").children("label").addClass("is_active"),$("#app_form_persondata_22").val(t[2]).parent(".group").children("label").addClass("is_active")}$("#app_form_persondata_25").val(e.data.address.value).parent(".group").children("label").addClass("is_active")}})):($(e).parent().children("label").text("Фамилия*"),$(t).parent().children("label").text("Имя*"),$(a).parent().children("label").text("Отчество"),$(n).parent().children("label").text("Е-почта*"),$(s).parent().children("label").text("Контактный телефон*"),$(i).parent().children("label").text("Адрес*"),$("#orgname").remove())})),$(".group").each((function(){let e=$(this).find(".app_form_textarea"),t=$(this).find("input"),a=$(this).find("label");$(e).on("input",(function(){$(e).val().length>0?$(a).addClass("is_active"):$(a).removeClass("is_active")})),$(t).on("input",(function(){$(t).val().length>0?$(a).addClass("is_active"):$(a).removeClass("is_active")}))})),$(".group").each((function(){let e=$(this).find("textarea");$(e).on("input",(function(){let e=$(this).data("text"),t=$(this).data("count"),a=e+" осталось "+(t-$(this).val().length)+" из "+t;t-$(this).val().length<0?$(this).next("label").css({color:"red"}).text("Лимит символов превышен!"):$(this).val().length>0?$(this).next("label").attr("style","").text(a):$(this).next("label").attr("style","").text(e)}))})),p(".doc_list"),p(".useful_link_list");const f=document.querySelectorAll(".list");function h(e){if(e.stopPropagation(),this.classList.contains("active"))this.classList.remove("active");else if(this.parentElement.parentElement.classList.contains("active"))this.classList.add("active");else{for(i=0;i<f.length;i++)f[i].classList.remove("active");this.classList.add("active")}}for($(f).find(".parent-selected").attr("href",""),i=0;i<f.length;i++)f[i].addEventListener("click",h);function u(e="search"){"search"==e?($(".search_btn").addClass("active"),$(".search_btn").removeClass("remove"),$(".search_btn").addClass("searched"),$(".search_btn").html('<i class="fa fa-search"></i> Искать')):"remove"==e?($(".search_btn").addClass("active"),$(".search_btn").removeClass("searched"),$(".search_btn").addClass("remove"),$(".search_btn").html('<i class="fa fa-times"></i> Очитстить')):$(".search_btn").removeClass("active")}$(".search").on("click",(function(){$(".top_content").fadeIn(200),$(".search_form").slideDown(300)})),$(".search_close").on("click",(function(){$(".search_form").slideUp(300),$(".top_content").fadeOut(200)})),$(".search_input").on("input",(function(){$(this).val().length>=3?u("search"):(u(""),$(".search_result").fadeOut("slow"))})),$("#search_filter_date").datepicker({onSelect:function(e,t,a){if(t){let t=e.split(" - ");$("input.date_from").val(t[0]),$("input.date_to").val(t[1])}}}).data("datepicker"),$("#search_filter_date").length>0&&($("input.date_from").val().length>0||$("input.date_to").val().length>0)&&$("#search_filter_date").val(`${$("input.date_from").val()} - ${$("input.date_to").val()}`),localStorage.getItem("search_param")?$("#search_params").addClass("active"):$("#search_params").removeClass("active"),$("a.search-page-params").on("click",(function(){$(this).toggleClass("active"),$(this).hasClass("active")?(localStorage.setItem("search_param","show"),$("#search_params").addClass("active")):(localStorage.removeItem("search_param"),$("#search_params").removeClass("active"))}));const m=document.getElementById("numbers");var _=[];let v=$(".num_item");for(let e=0;e<v.length;e++)_.push({score:parseInt($(v[e]).attr("data-start")),end:parseInt($(v[e]).attr("data-end"))});function g(e){document.querySelector('.num_item[data-target="'+e+'"] div').innerHTML=_[e].score.toFixed(0)}function b(e=5e3,t="",a="",n=""){toastr.options={closeButton:!0,debug:!1,newestOnTop:!1,progressBar:!0,positionClass:"toast-top-right",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:e,extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},toastr[t](a,n)}function C(e,t=!1,a=!1){let n=$(e).parent(".uploader_files").find(".uploader_files_item"),i=$(e).parent(".uploader_files").find(".uploader_files_list");$(n).on("click",(function(){$(e).trigger("click")}));var s={},o=$(i),l=o.find(".item").detach(),r=o.children().length;function c(){return r>0||a?5-r:0!=r&&a?void 0:5-o.children().length}function d(){let e;switch(c()){case 5:e='<span class="text">Прикрепить '+c()+" файлов</span>";break;case 0:e="Достигнут лимит";break;default:e="можно добавить ещё "+c()}$(n).html(e)}function p(e,t){var a=new FileReader;a.addEventListener("load",(function(a){if("jpeg"==t||"jpg"==t||"png"==t){document.createElement("img");(n=l.clone()).find(".img-wrap img").attr("src",a.target.result),n.data("id",e.name),o.append(n)}else{var n=l.clone();$(n).find(".img-wrap").remove();let a="fa-file";switch(t){case"xls":case"xlsx":a="fa-file-excel-o";break;case"rar":case"zip":a="fa-file-archive-o";break;case"docx":case"doc":a="fa-file-word-o";break;case"pdf":a="fa-file-pdf-o";break;default:a="fa-file"}n.find(".icon-wrap i").addClass(a),n.data("id",e.name),o.append(n)}n.on("click",(function(){delete s[e.name],$(this).remove(),d()})),s[e.name]=e,d()})),a.readAsDataURL(e)}return $(e).on("change",(function(){for(var e=0,t=0;t<this.files.length;t++)e+=this.files[t].size;return e})),$(e).on("change",(function(){for(var e=this.files,t=["jpeg","jpg","png","pdf","doc","docx","xls","xlsx","zip","rar"],a=0;a<c();a++){let n=e[a],i="";if(void 0!==n){if(i=n.name.split(".").pop(),$.inArray(i,t)<0){$(".errormassege").text(""),$(".errormassege").append("Файлы должны быть в формате jpg, jpeg, png, zip, doc, docx, xls, xlsx, pdf");continue}if(n.size>5242880){$(".errormassege").append("Размер файла не должен превышать 2 Мб");continue}$(".errormassege").html(""),p(n,i)}}this.value=""})),t&&($(e)[0].value="",d()),d(),s}null!==m&&window.addEventListener("scroll",(function(){const e=m.offsetTop,t=window.innerHeight;if(window.scrollY+t+30>e&&"000"==$(".num_item").children("div").text())for(let e=0;e<_.length;e++)TweenMax.to(_[e],4,{score:_[e].end,onUpdate:g,onUpdateParams:[e]})}));let w=C("#js-photo-upload",!1,!1);function x(){grecaptcha.ready((function(){grecaptcha.execute("6Lf3hssZAAAAAK2SOCPR9V8zAbClunlgAlNjYLKT",{action:"homepage"}).then((async e=>{document.getElementById("token").value=await e}))}))}function k(){$(".js_toggle-folder").on("click",(function(){let t=0,a=$(this).find(".fa-folder"),n=$(this).find(".fa-folder-open");$(".js_toggle-folder").not(this).each((function(){$(this).parent().removeClass("active"),$(this).removeClass("active"),e.to($(this).find(".fa-folder"),{opacity:1,duration:.01}),e.to($(this).find(".fa-folder-open"),{opacity:0,duration:.01}),t=$(this).innerHeight()})),$(this).parent().toggleClass("active"),$(this).toggleClass("active"),$(this).hasClass("active")?($(".folder-content").slideUp(200),$(".folder.active").children(".folder-content").slideDown(200),e.to($(a),{opacity:0,duration:.01}),e.to($(n),{opacity:1,duration:.01}),e.to($(".folder.active").children(".folder-content").children(".folder-item"),{y:0,opacity:1,stagger:.1,duration:.2}).then((function(e){let t=$(".folder.active").offset().top-$(window).scrollTop();(t>=200&&-1!=Math.sign(t)||-1==Math.sign(t))&&$("html, body").animate({scrollTop:parseInt($(".folder.active").offset().top)-50},300)}))):e.to($(".folder.active").children(".folder-content").children(".folder-item"),{y:-20,opacity:0,stagger:.1,duration:.02}).then((function(t){$(".folder-content").slideUp(200),e.to($(a),{opacity:1,duration:.01}),e.to($(n),{opacity:0,duration:.01}),$(".folder.active").children(".folder-content").slideUp(200)}))}))}x(),$(".app_form").on("submit",(function(e){e.preventDefault(),$(".btn_submit").hide(),$("#clock").show();let t=$(this).attr("method"),a=$(this).attr("action"),n=$("label"),i=$(this).find('input[type="text"]'),s=$(this).find('input[type="email"]'),o=$(this).find("textarea"),l=new FormData(this);for(var r in w)l.append("files[]",w[r]);$.ajax({url:a,type:t,data:l,contentType:!1,processData:!1,beforeSend:function(){NProgress.start()},complete:function(){NProgress.done(),$("#modal_app_form").iziModal("close")},success:function(e){let t=`<div class="app_form_message">\n                                    <span class="app_form_message_close">\n                                        <i class="fa fa-times"></i>\n                                    </span>\n                                    <h3 class="app_form_message_title">${e.title}</h3>\n                                    <p>${e.desc}</p>\n                                  </div>`;$(".app_form_message").remove(),$("body").append(t).fadeIn(200),$(".app_form_message_close").on("click",(function(){$(".app_form_message").remove()})),$(".form_tab").each((function(){4!=Number($(this).data("event-num"))&&($(this).find(".form_tab_event").html($(this).data("event-num")),$(this).removeClass("is_valid"))})),$("select#app_form_departament").select2("val","#"),$(n).removeClass("is_active"),$(i).removeClass("valid"),$(s).removeClass("valid"),$(o).removeClass("valid"),$(i).val(""),$(s).val(""),$(o).val(""),$("#app_form_persondata_18").prop("checked",!1),$("#app_form_consent").prop("checked",!0),$("#orgname").remove(),$("#clock").hide()},error:function(e){b(time=5e3,param="error",e,text="Обращение не отправлено!")}})})),k();let y=Math.max($(".content").outerHeight(),$("#sidebar").outerHeight());function S(e){return new Promise(((t,a)=>{ymaps.geocode(e).then((function(e){t(e.geoObjects.get(0).geometry.getCoordinates())}))}))}$("#sidebar").height(y),$(".left_menu li .sub_open").on("click",(function(e){e.stopPropagation();let t=$(this),a=t.closest("ul"),n=a.find(".active"),i=t.closest("li"),s=i.hasClass("active"),o=0;a.find("ul").slideUp((function(){++o==a.find("ul").length&&n.removeClass("active"),$("#sidebar").height(y)})),s||(i.children("ul").slideDown(),i.addClass("active"),$("#sidebar").height("100%"))})),$(".root-item").on("click",(function(){$(".root-item").removeClass("active"),$(this).addClass("active")})),ymaps.ready((async function(){let e,t,a,n,i=$(".interception-data").data("interception"),s=$(".interception-data").data("ot-interception"),o=$(".interception-data").data("do-interception");await S("г.Владикаквказ "+t).then((function(e){t=e})),await S("г.Владикаквказ пересечение "+i+" "+s).then((function(e){a=e})),await S("г.Владикаквказ пересечение "+i+" "+o).then((function(e){n=e})),e=new ymaps.multiRouter.MultiRoute({referencePoints:["г.Владикаквказ пересечение "+i+" "+s,"г.Владикаквказ пересечение "+i+" "+o]},{wayPointStartIconColor:"#FFFFFF",wayPointStartIconFillColor:"#ff0000",routeStrokeColor:"000088",routeActiveStrokeColor:"ff0000",pinIconFillColor:"ff0000",routeStrokeWidth:3,wayPointStartIconColor:"#FFFFFF",wayPointStartIconFillColor:"#ff0000",routeActiveStrokeWidth:8,routeActiveStrokeStyle:"solid",routeActiveStrokeColor:"#ff0000",routeStrokeWidth:3,boundsAutoApply:!1});var l=new ymaps.Map("map",{center:a,zoom:18,controls:[]},{searchControlProvider:"yandex#search",minZoom:14,maxZoom:17});l.geoObjects.add(e),l.behaviors.disable("click")})),$("#map").height(Math.max($(".news-map").height())+15),$(".vote-item-circle").each((function(){var e=$(this).find(".charts").children("#charts_data"),t=$(this).find(".legend"),a=[],n=[],i=[],s=$(this).find("#charts_canvas");for(let t=0;t<e.length;t++)a.push(e[t].dataset.color),n.push(e[t].dataset.counter),i.push(e[t].dataset.message);var o=function(e,t,a,n){return data={datasets:[{data:a,backgroundColor:t,borderWidth:0,borderColor:"#333"}],labels:n},new Chart(e,{type:"pie",data:data,options:{responsive:!0,legend:!1,legendCallback:function(e){var t=[];t.push("<ul>");for(var a=e.data.datasets[0],n=0;n<a.data.length;n++)t.push("<li>"),t.push('<span class="chart-legend" style="background-color:'+a.backgroundColor[n]+'"></span>'),t.push('<span class="chart-legend-label-text">'+a.data[n]+" "+e.data.labels[n]+"</span>"),t.push("</li>");return t.push("</ul>"),t.join("")},tooltips:{enabled:!0,mode:"label",callbacks:{label:function(e,t){var a=e.index;return t.datasets[0].data[a]+" "+t.labels[a]}}}}}).generateLegend()}(s,a,n,i);$(t).html(o)})),$(window).scroll((function(){0!=$(this).scrollTop()?$("#toTop").fadeIn():$("#toTop").fadeOut()})),$("#toTop").click((function(){$("body,html").animate({scrollTop:0},800)}))}jQuery((function(e){"serviceWorker"in navigator&&navigator.serviceWorker.register("/bitrix/templates/app/js/sw.js").then((e=>{})).catch((e=>{console.log(e)})),e(document).pjax('a:not("[no-data-pjax]"), #demo-list li a',"#pjax-container",{fragment:"#pjax-container",timeout:5e3}),e("#pjax-container").on("pjax:success",(function(){return!1})),e(document).on("pjax:start",(function(){NProgress.start()})),e(document).on("pjax:end",(function(t){let a=e(t.relatedTarget).attr("no-data-pjax");void 0!==a&&!1!==a||e("html, body").animate({scrollTop:0},"slow"),initializePlugins(),NProgress.done()})),initializePlugins()}));